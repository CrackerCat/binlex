<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>binlex: binlex</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">binlex
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">binlex </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>A Genetic Binary Trait Lexer Library and Utility</h2>
<p>The purpose of <code>binlex</code> is to extract basic blocks and functions as traits from binaries for malware research, hunting and detection.</p>
<p>Most projects attempting this use Python to generate traits, but it is very slow.</p>
<p>The design philosophy behind <code>binlex</code> is it to keep it simple and extendable.</p>
<p>The simple command-line interface allows malware researchers and analysts to hunt traits across hundreds or thousands of potentially similar malware saving time and money in production environments.</p>
<p>While the C++ API allows developers to get creative with their own detection solutions, completely unencumbered by license limitations.</p>
<p>To help combat malware, we firmly commit our work to the public domain for the greater good of the world.</p>
<p><a href="https://ci.appveyor.com/project/c3rb3ru5d3d53c/binlex"><img src="https://ci.appveyor.com/api/projects/status/wa423scoigl7xh7x/branch/master?svg=true" alt="Build status" class="inline"/></a> <a href="https://github.com/c3rb3ru5d3d53c/binlex/stargazers"><img src="https://img.shields.io/github/stars/c3rb3ru5d3d53c/binlex" alt="GitHub stars" class="inline"/></a> <a href="https://github.com/c3rb3ru5d3d53c/binlex/network"><img src="https://img.shields.io/github/forks/c3rb3ru5d3d53c/binlex" alt="GitHub forks" class="inline"/></a> <a href="https://discord.gg/UDBfRpxV3B"><img src="https://img.shields.io/discord/915569998469144636?logo=discord" alt="Discord Status" class="inline"/></a> <a href="https://github.com/c3rb3ru5d3d53c/binlex/blob/master/LICENSE"><img src="https://img.shields.io/github/license/c3rb3ru5d3d53c/binlex" alt="GitHub license" class="inline"/></a> <img src="https://img.shields.io/github/downloads/c3rb3ru5d3d53c/binlex/total" alt="GitHub all releases" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Demos</h1>
<p><img src="docs/img/demo_0.gif" alt="animated" class="inline"/> </p>
<h1><a class="anchor" id="autotoc_md2"></a>
Introduction Video</h1>
<p><a href="https://www.youtube.com/watch?v=hgz5gZB3DxE" target="_blank"><img src="https://img.youtube.com/vi/hgz5gZB3DxE/0.jpg" alt="Introduction Video" class="inline"/> </a> </p>
<p>Get slides <a href="docs/oalabs.pdf">here</a>.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Use Cases</h1>
<ul>
<li>YARA Signature Creation/Automation</li>
<li>Identifying Code-Reuse</li>
<li>Threat Hunting</li>
<li>Building Goodware Trait Corpus</li>
<li>Building Malware Trait Corpus</li>
<li>Genetic Programming</li>
<li>Machine Learning Malware Detection</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
Installing</h1>
<p><b>Dependencies:</b></p>
<p>To get started you will need the following dependencies for <code>binlex</code>.</p>
<div class="fragment"><div class="line">sudo apt install -y git build-essential \</div>
<div class="line">                    libcapstone-dev libssl-dev \</div>
<div class="line">                    cmake make parallel \</div>
<div class="line">                    doxygen git-lfs rpm liblief-dev</div>
<div class="line">                    python3 python3-dev</div>
<div class="line">git clone --recursive https://github.com/c3rb3ru5d3d53c/binlex.git</div>
<div class="line">cd binlex/</div>
</div><!-- fragment --><p>Please note that <code>binlex</code> requires <code>cmake</code> &gt;= 3.5 and <code>make</code> &gt;= 4.2.1.</p>
<p>Once you have installed, cloned and changed your directory to the project directory, we can continue with installation.</p>
<p><b>From Source:</b></p>
<p>If you want to compile and install via <code>make install</code> run the following commands:</p>
<div class="fragment"><div class="line">make threads=4</div>
<div class="line">sudo make install</div>
<div class="line"> </div>
<div class="line"># Test your installation</div>
<div class="line">binlex -m elf:x86 -i tests/elf/elf.x86</div>
</div><!-- fragment --><p><b>Binary Releases:</b></p>
<p>See the <a href="https://github.com/c3rb3ru5d3d53c/binlex/releases"><code>releases</code></a> page.</p>
<p>If you need the bleeding edge binaries you can download them from our AppVeyor CI/CD <a href="https://ci.appveyor.com/project/c3rb3ru5d3d53c/binlex/build/artifacts"><code>here</code></a>.</p>
<p>Please note, edge binaries are subject to bugs, if you encounter one, please let us know!</p>
<p><b>Test Files:</b></p><ul>
<li>To download all the test samples do the command <code>git lfs fetch</code></li>
<li>ZIP files in the <code>tests/</code> directory can then be extracted using the password <code>infected</code></li>
</ul>
<p><b>Building Packages:</b></p>
<p>Additionally, another option is to build Debian binary packages for and install those.</p>
<p>To build packages use <code>cpack</code>, which comes with <code>cmake</code>.</p>
<div class="fragment"><div class="line">make threads=4</div>
<div class="line">make pkg  # builds binary packages</div>
<div class="line">make dist # builds source packages</div>
<div class="line">sudo apt install ./build/binlex_1.1.1_amd64.deb</div>
<div class="line">binlex -m elf:x86 -i tests/elf/elf.x86</div>
</div><!-- fragment --><p>You will then be provided with <code>.deb</code>, <code>.rpm</code> and <code>.tar.gz</code> packages for <code>binlex</code>.</p>
<p><b>Building Python Bindings:</b></p>
<p>To get started using <code>pybinlex</code>: </p><div class="fragment"><div class="line">virtualenv -p python3 venv</div>
<div class="line">source venv/bin/activate</div>
<div class="line">python3 -m pip install -v -e .</div>
<div class="line">python3</div>
<div class="line">&gt;&gt;&gt; import pybinlex</div>
</div><!-- fragment --><p>If you wish to compile the bindings with <code>cmake</code>: </p><div class="fragment"><div class="line">make threads=4 args=&quot;-DBUILD_PYTHON_BINDINGS=true&quot;</div>
</div><!-- fragment --><p>For building with <code>cmake</code>, some installations may require you to override the <code>python</code> version: </p><div class="fragment"><div class="line">make threads=4 args=&quot;-DBUILD_PYTHON_BINDINGS=true -DPYBIND11_PYTHON_VERSION=3.8&quot;</div>
</div><!-- fragment --><p>Please note, we use <code>pybind11</code> and support for <code>python3.9</code> is experimental.</p>
<p>Examples of how to use <code>pybinlex</code> can be found in <code>tests.py</code>.</p>
<p><b>Building the Database:</b></p>
<p>You can create a <code>mongodb</code> database for <code>binlex</code> very easily.</p>
<p>When your <code>binlex</code> database is created it will add the default collections <code>default</code>, <code>malware</code> and <code>goodware</code>.</p>
<div class="fragment"><div class="line"># Install Docker Dependencies</div>
<div class="line">sudo apt install -y docker.io docker-compose</div>
<div class="line"> </div>
<div class="line"># Install MongoDB CLI Tools</div>
<div class="line">wget https://fastdl.mongodb.org/tools/db/mongodb-database-tools-ubuntu2004-x86_64-100.5.1.deb</div>
<div class="line">sudo apt install ./mongodb-database-tools-ubuntu2004-x86_64-100.5.1.deb</div>
<div class="line"> </div>
<div class="line"># Install MongoDB Compass</div>
<div class="line">wget https://downloads.mongodb.com/compass/mongodb-compass_1.29.6_amd64.deb</div>
<div class="line">sudo apt install ./mongodb-compass_1.29.6_amd64.deb</div>
<div class="line"> </div>
<div class="line"># Add user to docker group for non-root docker (requires login/logout)</div>
<div class="line">sudo usermod -a -G docker $USER</div>
<div class="line">sudo systemctl enable docker</div>
<div class="line"> </div>
<div class="line"># Build the Database</div>
<div class="line">make database admin_user=admin admin_pass=changeme user=binlex pass=changeme</div>
<div class="line"> </div>
<div class="line"># Start the Database</div>
<div class="line">make database-start</div>
<div class="line"> </div>
<div class="line"># Stop the Database</div>
<div class="line">make database-stop</div>
</div><!-- fragment --><p>Your connection string per user in this case would be:</p><ul>
<li>binlex - <code>mongodb://binlex:changeme@127.0.0.1/?authSource=binlex</code> (for trait collection)</li>
<li>admin - <code>mongodb://admin:changeme@127.0.0.1</code> (for administration)</li>
</ul>
<p>To administrate the database connect to <code>mongo-express</code> at <code><a href="http://127.0.0.1:8081">http://127.0.0.1:8081</a></code>, with the username <code>admin</code> and the password you setup.</p>
<p>Adding traits into your database is just as simple as piping your <code>binlex</code> output to the utility <code>mongoimport</code>.</p>
<div class="fragment"><div class="line"># Example Trait Collection into Database</div>
<div class="line">binlex -m pe:x86 -i tests/pe/pe.emotet.x86 -t 4 --corpus malware.emotet | mongoimport --db binlex -c malware -u binlex -p changeme --authenticationDatabase binlex</div>
</div><!-- fragment --><p>We recommend using <code>collections</code> as your main corpus name, so for example the corpus <code>malware.emotet</code> would go in the <code>malware</code> collection.</p>
<p>By default, <code>binlex</code> will use the corpus name <code>default</code>, which means you will in this case use the collection <code>default</code>.</p>
<p>Using the <code>default</code> corpus and collection is a great playground to store traits for initial analysis, while the <code>malware</code> and <code>goodware</code> corpus a great for long-term and confident storage of traits.</p>
<p>If you have a team of malware analysts you may need to add additional databases and users.</p>
<p>For that purpose you will need to create new users with the <code>admin</code> account and read MongoDB's user and roles management docs <a href="https://docs.mongodb.com/manual/tutorial/manage-users-and-roles/">here</a>.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Basic Usage</h1>
<div class="fragment"><div class="line">binlex v1.1.1 - A Binary Genetic Traits Lexer</div>
<div class="line">  -i  --input           input file              (required)</div>
<div class="line">  -m  --mode            set mode                (required)</div>
<div class="line">  -lm --list-modes      list modes</div>
<div class="line">  -c  --corpus          corpus name             (optional)</div>
<div class="line">  -t  --threads         number of threads       (optional)</div>
<div class="line">  -tc --thread-cycles   thread wait cycles      (optional)</div>
<div class="line">  -ts --thread-sleep    thread sleep in ms      (optional)</div>
<div class="line">  -to --timeout         execution timeout in s  (optional)</div>
<div class="line">  -h  --help            display help</div>
<div class="line">  -o  --output          output file             (optional)</div>
<div class="line">  -p  --pretty          pretty output           (optional)</div>
<div class="line">  -v  --version         display version</div>
<div class="line">Author: @c3rb3ru5d3d53c</div>
</div><!-- fragment --><p><b>Currently Supported Modes</b></p>
<ul>
<li><code>elf:x86</code></li>
<li><code>elf:x86_64</code></li>
<li><code>pe:x86</code></li>
<li><code>pe:x86_64</code></li>
<li><code>raw:x86</code></li>
<li><code>raw:x86_64</code></li>
<li><code>raw:cil</code> (experimental)</li>
</ul>
<p><b>NOTE:</b> The <code>raw</code> formats can be used on shellcode</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Advanced Usage</h1>
<p>If you are hunting using <code>binlex</code> you can use <code>jq</code> to your advantage for advanced searches.</p>
<div class="fragment"><div class="line">binlex -m raw:x86 -i tests/raw/raw.x86 | jq -r &#39;select(.type == &quot;block&quot; and .size &lt; 32 and .size &gt; 0) | .bytes&#39;</div>
<div class="line">2c 20 c1 cf 0d 01 c7 49 75 ef</div>
<div class="line">52 57 8b 52 10 8b 42 3c 01 d0 8b 40 78 85 c0 74 4c</div>
<div class="line">01 d0 50 8b 58 20 8b 48 18 01 d3 85 c9 74 3c</div>
<div class="line">49 8b 34 8b 01 d6 31 ff 31 c0 c1 cf 0d ac 01 c7 38 e0 75 f4</div>
<div class="line">03 7d f8 3b 7d 24 75 e0</div>
<div class="line">58 5f 5a 8b 12 e9 80 ff ff ff</div>
<div class="line">ff 4e 08 75 ec</div>
<div class="line">e8 67 00 00 00 6a 00 6a 04 56 57 68 02 d9 c8 5f ff d5 83 f8 00 7e 36</div>
<div class="line">e9 9b ff ff ff</div>
<div class="line">01 c3 29 c6 75 c1</div>
</div><!-- fragment --><p>Other queries you can do: </p><div class="fragment"><div class="line"># Block traits with a size between 0 and 32 bytes</div>
<div class="line">jq -r &#39;select(.type == &quot;block&quot; and .size &lt; 32 and .size &gt; 0)&#39;</div>
<div class="line"># Function traits with a cyclomatic complexity greater than 32 (maybe obfuscation)</div>
<div class="line">jq -r &#39;select(.type == &quot;function&quot; and .cyclomatic_complexity &gt; 32)&#39;</div>
<div class="line"># Traits where bytes have high entropy</div>
<div class="line">jq -r &#39;select(.bytes_entropy &gt; 7)&#39;</div>
<div class="line"># Output all trait strings only</div>
<div class="line">jq -r &#39;.trait&#39;</div>
<div class="line"># Output only trait hashes</div>
<div class="line">jq -r &#39;.trait_sha256&#39;</div>
</div><!-- fragment --><p>If you output just traits you want to <code>stdout</code> you can do build a <code>yara</code> signature on the fly with the included tool <code>blyara</code>:</p>
<div class="fragment"><div class="line">build/binlex -m raw:x86 -i tests/raw/raw.x86 | jq -r &#39;select(.size &gt; 16 and .size &lt; 32) | .trait&#39; | build/blyara --name example_0 -m author example -m tlp white -c 1</div>
<div class="line">rule example_0 {</div>
<div class="line">    metadata:</div>
<div class="line">        author = &quot;example&quot;</div>
<div class="line">        tlp = &quot;white&quot;</div>
<div class="line">    strings:</div>
<div class="line">        trait_0 = {52 57 8b 52 ?? 8b 42 ?? 01 d0 8b 40 ?? 85 c0 74 4c}</div>
<div class="line">        trait_1 = {49 8b 34 8b 01 d6 31 ff 31 c0 c1 cf ?? ac 01 c7 38 e0 75 f4}</div>
<div class="line">        trait_2 = {e8 67 00 00 00 6a 00 6a ?? 56 57 68 ?? ?? ?? ?? ff d5 83 f8 00 7e 36}</div>
<div class="line">    condition:</div>
<div class="line">        1 of them</div>
<div class="line">}</div>
</div><!-- fragment --><p>You can also use the switch <code>--pretty</code> to output <code>json</code> to identify more properies to query.</p>
<div class="fragment"><div class="line">binlex -m pe:x86 -i tests/pe/pe.trickbot.x86 --pretty</div>
<div class="line">[</div>
<div class="line">  {</div>
<div class="line">    &quot;average_instructions_per_block&quot;: 29,</div>
<div class="line">    &quot;blocks&quot;: 1,</div>
<div class="line">    &quot;bytes&quot;: &quot;ae 32 c3 32 1a 33 25 34 85 39 ae 3b b4 3b c8 3b 35 3c 3a 3c 6b 3c 71 3c 85 3c aa 3d b0 3d 6a 3e a5 3e b8 3e fd 3e 38 3f 4b 3f 87 3f 00 20 00 00 58 00 00 00 4f 30 aa 30 01 31 1d 31 ac 31 d6 31 e5 31 f5 31 1c 32 31 32 75 34&quot;,</div>
<div class="line">    &quot;bytes_entropy&quot;: 5.070523738861084,</div>
<div class="line">    &quot;bytes_sha256&quot;: &quot;67a966fe573ef678feaea6229271bb374304b418fe63f464b71af1fbe2a87f37&quot;,</div>
<div class="line">    &quot;cyclomatic_complexity&quot;: 3,</div>
<div class="line">    &quot;edges&quot;: 2,</div>
<div class="line">    &quot;instructions&quot;: 29,</div>
<div class="line">    &quot;offset&quot;: 11589,</div>
<div class="line">    &quot;size&quot;: 74,</div>
<div class="line">    &quot;trait&quot;: &quot;ae 32 c3 32 1a 33 25 ?? ?? ?? ?? 3b b4 3b ?? ?? ?? ?? 3a 3c 6b 3c 71 3c 85 3c aa 3d b0 3d 6a 3e a5 3e b8 3e fd 3e 38 3f 4b 3f 87 3f 00 20 00 00 58 00 00 00 4f ?? aa 30 01 31 1d ?? ?? ?? ?? 31 e5 31 f5 31 1c 32 31 32 75 34&quot;,</div>
<div class="line">    &quot;trait_entropy&quot;: 4.9164042472839355,</div>
<div class="line">    &quot;trait_sha256&quot;: &quot;a00fcb2b23a916192990665d8a5f53b2adfa74ec98991277e571542aee94c3a5&quot;,</div>
<div class="line">    &quot;type&quot;: &quot;block&quot;</div>
<div class="line">  }</div>
<div class="line">]</div>
</div><!-- fragment --><p>If you have terabytes of executable files, we can leverage the power of <code>parallel</code> to generate traits for us.</p>
<div class="fragment"><div class="line">make traits source=samples/malware/pe/x32/ dest=dist/ type=malware format=pe arch=x86 threads=4</div>
<div class="line">make traits-combine source=dist/ dest=dist/ type=malware format=pe arch=x86 threads=4</div>
</div><!-- fragment --><p>It also allows you to name your type of dataset, i.e. goodware/malware/riskware/pua etc...</p>
<p>With <code>binlex</code> it is up to you to remove goodware traits from your extracted traits.</p>
<p>There have been many questions about removing "library code", there is a make target shown below to help you with this.</p>
<div class="fragment"><div class="line">make traits-clean remove=goodware.traits source=sample.traits dest=malware.traits</div>
</div><!-- fragment --><p>With <code>binlex</code> the power is in your hands, "With great power comes great responsibility", it is up to you!</p>
<p><b>Plugins:</b></p>
<p>There has been some interest in making IDA, Ghidra and Cutter plugins for <code>binlex</code>.</p>
<p>This is something that will be started soon.</p>
<p>This <code>README.md</code> will be updated when they are ready to use.</p>
<p><b>General Usage Information:</b></p>
<p>Binlex is designed to do one thing and one thing only, extract genetic traits from executable code in files. This means it is up to you "the researcher" / "the data scientist" to determine which traits are good and which traits are bad. To accomplish this, you need to use your own <a href="https://en.wikipedia.org/wiki/Fitness_function">fitness function</a>. I encourage you to read about <a href="https://en.wikipedia.org/wiki/Genetic_programming">genetic programming</a> to gain a better understanding of this in practice. Perhaps watching <a href="https://www.youtube.com/watch?v=qiKW1qX97qA">this</a> introductory video will help your understanding.</p>
<p>Again, <b>it's up to you to implement your own algorithms for detection based on the genetic traits you extract</b>.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Trait Format</h1>
<p>Traits will contain binary code represented in hexadecimal form and will use <code>??</code> as wild cards for memory operands or other operands subject to change.</p>
<p>They will also contain additional properties about the trait including its <code>offset</code>, <code>edges</code>, <code>blocks</code>, <code>cyclomatic_complexity</code>, <code>average_instruction_per_block</code>, <code>bytes</code>, <code>trait</code>, <code>trait_sha256</code>, <code>bytes_sha256</code>, <code>trait_entropy</code>, <code>bytes_entropy</code>, <code>type</code>, <code>size</code>, <code>invalid_instructions</code> and <code>instructions</code>.</p>
<div class="fragment"><div class="line">[</div>
<div class="line">  {</div>
<div class="line">    &quot;average_instructions_per_block&quot;: 29,</div>
<div class="line">    &quot;blocks&quot;: 1,</div>
<div class="line">    &quot;bytes&quot;: &quot;ae 32 c3 32 1a 33 25 34 85 39 ae 3b b4 3b c8 3b 35 3c 3a 3c 6b 3c 71 3c 85 3c aa 3d b0 3d 6a 3e a5 3e b8 3e fd 3e 38 3f 4b 3f 87 3f 00 20 00 00 58 00 00 00 4f 30 aa 30 01 31 1d 31 ac 31 d6 31 e5 31 f5 31 1c 32 31 32 75 34&quot;,</div>
<div class="line">    &quot;bytes_entropy&quot;: 5.070523738861084,</div>
<div class="line">    &quot;bytes_sha256&quot;: &quot;67a966fe573ef678feaea6229271bb374304b418fe63f464b71af1fbe2a87f37&quot;,</div>
<div class="line">    &quot;cyclomatic_complexity&quot;: 3,</div>
<div class="line">    &quot;edges&quot;: 2,</div>
<div class="line">    &quot;instructions&quot;: 29,</div>
<div class="line">    &quot;offset&quot;: 11589,</div>
<div class="line">    &quot;size&quot;: 74,</div>
<div class="line">    &quot;trait&quot;: &quot;ae 32 c3 32 1a 33 25 ?? ?? ?? ?? 3b b4 3b ?? ?? ?? ?? 3a 3c 6b 3c 71 3c 85 3c aa 3d b0 3d 6a 3e a5 3e b8 3e fd 3e 38 3f 4b 3f 87 3f 00 20 00 00 58 00 00 00 4f ?? aa 30 01 31 1d ?? ?? ?? ?? 31 e5 31 f5 31 1c 32 31 32 75 34&quot;,</div>
<div class="line">    &quot;trait_entropy&quot;: 4.9164042472839355,</div>
<div class="line">    &quot;trait_sha256&quot;: &quot;a00fcb2b23a916192990665d8a5f53b2adfa74ec98991277e571542aee94c3a5&quot;,</div>
<div class="line">    &quot;type&quot;: &quot;block&quot;</div>
<div class="line">  }</div>
<div class="line">]</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md8"></a>
Documentation</h1>
<p>Public documentation on <code>binlex</code> can be viewed <a href="https://c3rb3ru5d3d53c.github.io/binlex/html/index.html">here</a>.</p>
<h1><a class="anchor" id="autotoc_md9"></a>
Building Docs</h1>
<p>You can access the C++ API Documentation and everything else by building the documents using <code>doxygen</code>.</p>
<div class="fragment"><div class="line">make docs threads=4</div>
</div><!-- fragment --><p>The documents will be available at <code>build/docs/html/index.html</code>.</p>
<h1><a class="anchor" id="autotoc_md10"></a>
C++ API Example Code</h1>
<p>It couldn't be any easier to leverage <code>binlex</code> and its C++ API to build your own applications.</p>
<p>See example code below:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;binlex/pe.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;binlex/decompiler.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacebinlex.html">binlex</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv){</div>
<div class="line">  Pe pe32;</div>
<div class="line">  <span class="keywordflow">if</span> (pe32.Setup(PE_MODE_X86) == <span class="keyword">false</span>){</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (pe32.ReadFile(argv[1]) == <span class="keyword">false</span>){</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="classbinlex_1_1Decompiler.html">Decompiler</a> decompiler;</div>
<div class="line">  decompiler.<a class="code" href="classbinlex_1_1Decompiler.html#a06e1364161c87831a2c36482a9b08093">Setup</a>(CS_ARCH_X86, CS_MODE_32);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; PE_MAX_SECTIONS; i++){</div>
<div class="line">      <span class="keywordflow">if</span> (pe32.sections[i].data != NULL){</div>
<div class="line">          decompiler.x86_64(pe32.sections[i].data, pe32.sections[i].size, pe32.sections[i].offset, i);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line">  decompiler.<a class="code" href="classbinlex_1_1Decompiler.html#a788f80fd44f34f00084375d4669bd443">PrintTraits</a>(args.options.pretty);</div>
<div class="line">}</div>
</div><!-- fragment --><p>We hope this encourages people to build their own detection solutions based on binary genetic traits.</p>
<h1><a class="anchor" id="autotoc_md11"></a>
Tips</h1>
<ul>
<li>If you are hunting be sure to use <code>jq</code> to improve your searches</li>
<li>Does not support PE files that are VB6 or .NET if you run against these you will get errors</li>
<li>Don't mix packed and unpacked malware or you will taint your dataset (seen this in academics all the time)</li>
<li>Verify the samples you are collecting into a group using skilled analysts</li>
<li>These traits are best used with a hybrid approach (supervised)</li>
</ul>
<h1><a class="anchor" id="autotoc_md12"></a>
Example Fitness Model</h1>
<p>Traits will be compared amongst their common malware family, any traits not common to all samples will be discarded.</p>
<p>Once completed, all remaining traits will be compared to traits from a goodware set, any traits that match the goodware set will be discarded.</p>
<p>To further differ the traits from other malware families, the remaining population will be compared to other malware families, any that match will be discarded.</p>
<p>The remaining population of traits will be unique to the malware family tested and not legitimate binaries or other malware families.</p>
<p>This fitness model allows for accurate classification of the tested malware family.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Future Work</h1>
<ul>
<li>Recursive Decompiler</li>
<li>Java Bytecode Support <code>raw:jvm</code>, <code>java:jvm</code></li>
<li>Cutter, Ghidra and IDA Plugins</li>
<li>.NET support <code>pe:cil</code> and <code>raw:cil</code></li>
<li>Mac-O Support <code>macho:x86_64</code>, <code>macho:x86</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md14"></a>
Contributing</h1>
<p>If you wish to contribute to Binlex DM me on Twitter <a href="https://twitter.com/c3rb3ru5d3d53c">here</a>.</p>
<p>You can also join our Discord <a href="https://discord.gg/UDBfRpxV3B">here</a>.</p>
<p>Currently looking for help on:</p><ul>
<li>MacOS Developer (Parse Mach-O)</li>
<li>Plugin Developers (Python) </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassbinlex_1_1Decompiler_html_a788f80fd44f34f00084375d4669bd443"><div class="ttname"><a href="classbinlex_1_1Decompiler.html#a788f80fd44f34f00084375d4669bd443">binlex::Decompiler::PrintTraits</a></div><div class="ttdeci">void PrintTraits(bool pretty)</div></div>
<div class="ttc" id="aclassbinlex_1_1Decompiler_html_a06e1364161c87831a2c36482a9b08093"><div class="ttname"><a href="classbinlex_1_1Decompiler.html#a06e1364161c87831a2c36482a9b08093">binlex::Decompiler::Setup</a></div><div class="ttdeci">bool Setup(cs_arch arch, cs_mode mode, uint index)</div></div>
<div class="ttc" id="aclassbinlex_1_1Decompiler_html"><div class="ttname"><a href="classbinlex_1_1Decompiler.html">binlex::Decompiler</a></div><div class="ttdef"><b>Definition:</b> decompiler.h:27</div></div>
<div class="ttc" id="anamespacebinlex_html"><div class="ttname"><a href="namespacebinlex.html">binlex</a></div><div class="ttdoc">the binlex namespace</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
